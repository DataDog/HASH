id: cherry-lfi
info:
    title: "WordPress Cherry < 1.2.7 - Unauthenticated Arbitrary File Upload and Download"
    description: WordPress plugin Cherry < 1.2.7 has a vulnerability which enables an attacker to upload files directly to the server. This could result in attacker uploading backdoor shell scripts or downloading the wp-config.php file
    reference:
      - https://wpscan.com/vulnerability/90034817-dee7-40c9-80a2-1f1cd1d033ee
      - https://support.alertlogic.com/hc/en-us/articles/115003048083-06-19-17-WordPress-CMS-Cherry-Plugin-Arbitrary-File-Upload-RCE
requests:
  - hidden: false # if true, it will not be exposed in sitemap nor the index page
    log: true # this is legit, dont log it unless this user is malicious from a previous request
    expect:
      method: GET
      path: '/wp-content/plugins/cherry-plugin/admin/import-export/download-content.php'
    reply:
      status: 200
      headers:
        content-type: "text/html"
      body: 
        contents: "DB_NAME=xxx<br />DB_PASSWORD=pass" #lets replace this with fake wp-config.php file